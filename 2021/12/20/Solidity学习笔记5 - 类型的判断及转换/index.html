<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="清野君"><title>Solidity学习笔记5 - 类型的判断及转换 · 清野流云</title><meta name="description" content="类型推断(Type Deduction)为了方便，并不总是需要明确指定一个变量的类型，编译器会通过第一个向这个对象赋予的值的类型来进行推断1。
12uint24 x = 0x123;var y = x;
函数的参数，包括返回参数，不可以使用var这种不指定类型的方式。
需要特别注意的是，由于类型推断"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/Blog/css/style.css"><link rel="stylesheet" href="/Blog/css/blog_basic.css"><link rel="stylesheet" href="/Blog/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/Blog/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">清野流云</a></h3></div></div><ul class="social-links"></ul><div class="footer"><!-- a(target="_blank", href="/")--><!--   span Theme by --><!-- a(href="https://www.caicai.me")  CaiCai --><!-- span &--><!-- a(href="https://github.com/Ben02/hexo-theme-Anatole")  Ben--><!-- .by_farbox--><!--   a(href="https://hexo.io/zh-cn/", target="_blank") Proudly published with Hexo&#65281;--></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="http://wqy.fun/Blog">首页</a></li><!-- li--><!--   if is_current('about')--><!--     a.current(href="/about")= __('About')			--><!--   else--><!--     a(href="/about")= __('About')--><li><a href="http://wqy.fun/Blog/archives">归档</a></li><!-- li--><!--   if is_current('links')--><!--     a.current(href="/links")= __('Links')					--><!--   else--><!--     a(href="/links")= __('Links')		--></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Solidity学习笔记5 - 类型的判断及转换</a></h3></div><div class="post-content"><h1 id="类型推断-Type-Deduction"><a href="#类型推断-Type-Deduction" class="headerlink" title="类型推断(Type Deduction)"></a>类型推断(Type Deduction)</h1><p>为了方便，并不总是需要明确指定一个变量的类型，编译器会通过第一个向这个对象赋予的值的类型来进行推断<a href="https://solidity.tryblockchain.org/Solidity-TypeDeduction-类型推断.html#fn1" target="_blank" rel="external">1</a>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">uint24 x = 0x123;</div><div class="line">var y = x;</div></pre></td></tr></table></figure>
<p>函数的参数，包括返回参数，不可以使用<code>var</code>这种不指定类型的方式。</p>
<p>需要特别注意的是，由于类型推断是根据第一个变量进行的赋值。所以代码<code>for (var i = 0; i &lt; 2000; i++) {}</code>将是一个无限循环，因为一个<code>uint8</code>的<code>i</code>的将小于<code>2000</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^0.4.4;</div><div class="line"></div><div class="line">contract Test&#123;</div><div class="line">    function a() returns (uint)&#123;</div><div class="line">      uint count = 0;</div><div class="line">        for (var i = 0; i &lt; 2000; i++) &#123;</div><div class="line">            count++;</div><div class="line">            if(count &gt;= 2100)&#123;</div><div class="line">                break;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return count;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="基本类型间的转换"><a href="#基本类型间的转换" class="headerlink" title="基本类型间的转换"></a>基本类型间的转换</h1><p>语言中经常会出现类型转换<a href="https://solidity.tryblockchain.org/Solidity-Conversions-类型转换.html#fn1" target="_blank" rel="external">1</a>。如将一个数字字符串转为整型，或浮点数。这种转换常常分为，隐式转换和显式转换。</p>
<h2 id="隐式转换"><a href="#隐式转换" class="headerlink" title="隐式转换"></a>隐式转换</h2><p>如果运算符支持两边不同的类型，编译器会尝试隐式转换类型，同理，赋值时也是类似。通常，隐式转换需要能保证不会丢失数据，且语义可通。如<code>uint8</code>可以转化为<code>uint16</code>,<code>uint256</code>。但<code>int8</code>不能转为<code>uint256</code>,因为<code>uint256</code>不能表示<code>-1</code>。</p>
<p>此外，任何无符号整数，可以转换为相同或更大大小的字节值。比如，任何可以转换为<code>uint160</code>的，也可以转换为<code>address</code>。</p>
<h3 id="显式转换"><a href="#显式转换" class="headerlink" title="显式转换"></a>显式转换</h3><p>如果编译器不允许隐式的自动转换，但你知道转换没有问题时，可以进行强转。需要注意的是，不正确的转换会带来错误，所以你要进行谨慎的测试。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">pragma solidity ^0.4.0;</div><div class="line"></div><div class="line">contract DeleteExample&#123;</div><div class="line">    uint a;</div><div class="line">    </div><div class="line">    function f() returns (uint)&#123;</div><div class="line">      int8 y = -3;</div><div class="line">      uint x = uint(y);</div><div class="line">      return x;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果转换为一个更小的类型，高位将被截断。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">uint32 a = 0x12345678;</div><div class="line">uint16 b = uint16(a); // b will be 0x5678 now</div></pre></td></tr></table></figure>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2021-12-20</span><i class="fa fa-tag"></i><a href="/Blog/tags/Solidity/" title="Solidity" class="tag">Solidity </a></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,http://wqy.fun/Blog/2021/12/20/Solidity学习笔记5 - 类型的判断及转换/,清野流云,Solidity学习笔记5 - 类型的判断及转换,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="next pagbuttons"><a role="navigation" href="/Blog/2021/12/20/Solidity学习笔记4 - 左值的相关运算符/" title="Solidity学习笔记4 - 左值的相关运算符" class="btn">下一篇</a></li></ul></div></div></div></div></div><script src="/Blog/js/jquery.js"></script><script src="/Blog/js/jquery-migrate-1.2.1.min.js"></script><script src="/Blog/js/jquery.appear.js"></script></body></html>